---
title: "R Notebook"
output: html_notebook
---

```{r}
codes = function(){
  
  #ANOVA & Kruskal-Wallis
  d=data.frame(r) ; s=stack(d) ; leveneTest(s$values,s$ind,center="mean") 
  a=aov(s$values~s$ind) ; summary(a)
  kruskal.test(s$values,s$ind) 
  
  #Posthoc
  ScheffeTest(a,contrasts=matrix(c(0,-0.5,1,-0.5),ncol=1)) 
  TukeyHSD(a)
  a1=oneway(d$ind,y=d$values,posthoc='games-howell') 
  posthoc.kruskal.nemenyi.test(s$values,s$ind,"Tukey")

  #Logistic & Variable Selection & Prediction
  r$Adherence=factor(r$Adherence,levels=c(0,1),labels = c("Yes","No"))
  a1=glm(Adherence~.,data=r,family="binomial") ; summary(a1); exp(cbind(OR=coef(a1),confint(a1)))
  newdata = with(r,data.frame(Age = 30, Gender ='Female', Residence ='Rural', Income = '4500-6000'))
  predict(a1, newdata, type="response") ; predicted_prob <- predict(a1, type="response") ;r$predict = predicted_prob
  
  b=step(a1) ; summary(b)
  null=glm(Adherence~1,data=r,family="binomial")
  f=step(null,scope=list(lower=formula(null),upper=formula(a1)),direction = "forward") ; summary(f)
  both = step(null,  scope = list(lower=formula(null), upper=formula(a1)), direction = "both") ; summary(both)
  
  #Random Walk
  x=array() ;r=array() ;z=array() ;x=NULL ;x[1]=0
  for(i in 2:51){
  r[i]=runif(1,0,1)
  if(r[i] <= 0.25){z=-1}
  if(r[i] >0.25 && r[i]<=0.55){z=0}
  if(r[i] > 0.55){z=1} ;z
  x[i]=x[i-1] + z } ;x
  plot(x,type="s",ylab="State Space",main="Sample path for Random Walk")
  
  #Bayesian
  library(Bolstad2)
  b=binobp(6,15,2,4)
  pi=seq(0,1,by=0.001);pi.prior=NULL;pi.prior[pi<=1] = 0; pi.prior[pi<=0.5] = 0.5 - pi[pi<=0.5] ;pi.prior[pi<=0.3] = 0.2   ;pi.prior[pi<=0.2] = pi[pi<=0.2] ;results=binogcp(7,20,density = "user", pi=pi, pi.prior = pi.prior)

  pi=seq(0,1,by=0.001);pi.prior=NULL;pi.prior[pi<=1] = 1 ;
  results1=binogcp(7,20,density = "user", pi=pi, pi.prior = pi.prior)

  #Stochastic
  library(DTMCPack)
  P=matrix(c(1,0,0,0.8,0.15,0.05,0.8,0.15,0.05),byrow=TRUE,nrow=3) ; rownames(P)=colnames(P)=c("ND","DS","DD")
  statdistr(P)
  I=matrix(c(1,0,0,1),byrow=TRUE,nrow=2) ;Q=P[2:3,2:3] ;F=solve(I-Q)
  R=P[2:3,1:1] ; F%*%R
  
}




```

